// Mock product data (expand as needed)
const products = [
    { id: 1, name: "Smartphone", price: 299, category: "electronics", image: "https://via.placeholder.com/200", description: "Latest smartphone with great features." },
    { id: 2, name: "T-Shirt", price: 19, category: "fashion", image: "https://via.placeholder.com/200", description: "Comfortable cotton t-shirt." },
    { id: 3, name: "Blender", price: 49, category: "home", image: "https://via.placeholder.com/200", description: "Powerful kitchen blender." },
    { id: 4, name: "Novel Book", price: 9, category: "books", image: "https://via.placeholder.com/200", description: "Bestselling fiction novel." },
    // Add more products here
];

let cart = JSON.parse(localStorage.getItem('cart')) || [];
let currentCategory = 'all';

// Display products
function displayProducts(filteredProducts) {
    const container = document.getElementById('products');
    container.innerHTML = '';
    filteredProducts.forEach(product => {
        container.innerHTML += `
            <div class="col-md-3">
                <div class="card product-card" onclick="showProduct(${product.id})">
                    <img src="${product.image}" class="card-img-top" alt="${product.name}">
                    <div class="card-body">
                        <h5 class="card-title">${product.name}</h5>
                        <p class="card-text">$${product.price}</p>
                    </div>
                </div>
            </div>
        `;
    });
    updateCartCount();
}

// Filter by category
function filterCategory(category) {
    currentCategory = category;
    const filtered = category === 'all' ? products : products.filter(p => p.category === category);
    displayProducts(filtered);
}

// Search products
document.getElementById('search').addEventListener('input', (e) => {
    const query = e.target.value.toLowerCase();
    const filtered = products.filter(p => p.name.toLowerCase().includes(query) && (currentCategory === 'all' || p.category === currentCategory));
    displayProducts(filtered);
});

// Show product modal
function showProduct(id) {
    const product = products.find(p => p.id === id);
    document.getElementById('modal-title').textContent = product.name;
    document.getElementById('modal-image').src = product.image;
    document.getElementById('modal-description').textContent = product.description;
    document.getElementById('modal-price').textContent = product.price;
    document.getElementById('add-to-cart').onclick = () => addToCart(id);
    new bootstrap.Modal(document.getElementById('productModal')).show();
}

// Add to cart
function addToCart(id) {
    const product = products.find(p => p.id === id);
    const existing = cart.find(item => item.id === id);
    if (existing) {
        existing.quantity++;
    } else {
        cart.push({ ...product, quantity: 1 });
    }
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
    alert('Added to cart!');
}

// Update cart count
function updateCartCount() {
    document.getElementById('cart-count').textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
}

// Show cart
document.getElementById('cart-btn').addEventListener('click', () => {
    const cartItems = document.getElementById('cart-items');
    cartItems.innerHTML = '';
    let total = 0;
    cart.forEach(item => {
        total += item.price * item.quantity;
        cartItems.innerHTML += `
            <div class="d-flex justify-content-between align-items-center mb-2">
                <span>${item.name} (x${item.quantity})</span>
                <span>$${item.price * item.quantity}</span>
                <button class="btn btn-sm btn-danger" onclick="removeFromCart(${item.id})">Remove</button>
            </div>
        `;
    });
    document.getElementById('cart-total').textContent = total;
    new bootstrap.Modal(document.getElementById('cartModal')).show();
});

// Remove from cart
function removeFromCart(id) {
    cart = cart.filter(item => item.id !== id);
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
    document.getElementById('cart-btn').click(); // Refresh modal
}

// Checkout (placeholder)
function checkout() {
    alert('Checkout functionality not implemented. Integrate with Stripe/PayPal.');
    cart = [];
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
}

// Initial load
displayProducts(products);
